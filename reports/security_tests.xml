<?xml version="1.0" encoding="utf-8"?><testsuites name="pytest tests"><testsuite name="pytest" errors="20" failures="16" skipped="0" tests="126" time="20.935" timestamp="2025-08-09T14:58:20.571832+10:00" hostname="Jackela"><testcase classname="tests.security.test_cors_security.TestCORSConfig" name="test_detect_environment_development" time="0.007" /><testcase classname="tests.security.test_validation_security.TestSecurityValidation" name="test_sql_injection_detection" time="0.005"><failure message="Failed: DID NOT RAISE &lt;class 'backend.api.models.SecurityValidationError'&gt;">tests\security\test_validation_security.py:42: in test_sql_injection_detection
    with pytest.raises(SecurityValidationError) as exc_info:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE &lt;class 'backend.api.models.SecurityValidationError'&gt;</failure></testcase><testcase classname="tests.security.test_cors_api_integration.TestCORSAPIIntegration" name="test_development_cors_allows_localhost" time="4.304" /><testcase classname="tests.security.test_cors_security.TestCORSConfig" name="test_detect_environment_production" time="0.007" /><testcase classname="tests.security.test_cors_security.TestCORSConfig" name="test_detect_environment_aliases" time="0.023" /><testcase classname="tests.security.test_api_security_integration.TestAPISecurityIntegration" name="test_valid_query_parameters_accepted" time="4.391" /><testcase classname="tests.security.test_cors_security.TestCORSConfig" name="test_parse_origins_basic" time="0.002" /><testcase classname="tests.security.test_cors_security.TestCORSConfig" name="test_parse_origins_with_spaces" time="0.002" /><testcase classname="tests.security.test_cors_security.TestCORSConfig" name="test_parse_origins_empty" time="0.002" /><testcase classname="tests.security.test_cors_security.TestCORSConfig" name="test_development_config" time="0.006" /><testcase classname="tests.security.test_cors_security.TestCORSConfig" name="test_testing_config" time="0.006" /><testcase classname="tests.security.test_cors_security.TestCORSConfig" name="test_production_config_with_origins" time="0.006" /><testcase classname="tests.security.test_cors_security.TestCORSConfig" name="test_production_config_no_origins_raises_error" time="0.007" /><testcase classname="tests.security.test_cors_security.TestCORSConfig" name="test_production_security_validation_wildcard" time="0.006" /><testcase classname="tests.security.test_cors_security.TestCORSConfig" name="test_production_security_validation_localhost" time="0.008" /><testcase classname="tests.security.test_cors_security.TestCORSConfig" name="test_production_security_validation_http" time="0.006" /><testcase classname="tests.security.test_cors_security.TestCORSConfig" name="test_staging_config" time="0.006" /><testcase classname="tests.security.test_cors_security.TestCORSValidation" name="test_validate_origin_format[http://localhost:3000-True]" time="0.002" /><testcase classname="tests.security.test_cors_security.TestCORSValidation" name="test_validate_origin_format[https://example.com-True]" time="0.001" /><testcase classname="tests.security.test_cors_security.TestCORSValidation" name="test_validate_origin_format[https://sub.example.com-True]" time="0.002" /><testcase classname="tests.security.test_cors_security.TestCORSValidation" name="test_validate_origin_format[http://127.0.0.1:8000-True]" time="0.002" /><testcase classname="tests.security.test_cors_security.TestCORSValidation" name="test_validate_origin_format[-False]" time="0.002" /><testcase classname="tests.security.test_cors_security.TestCORSValidation" name="test_validate_origin_format[localhost:3000-False]" time="0.002" /><testcase classname="tests.security.test_cors_security.TestCORSValidation" name="test_validate_origin_format[http://example.com/-False]" time="0.002" /><testcase classname="tests.security.test_cors_security.TestCORSValidation" name="test_validate_origin_format[ftp://example.com-False]" time="0.002" /><testcase classname="tests.security.test_cors_security.TestCORSValidation" name="test_validate_origin_format[http://-False]" time="0.002" /><testcase classname="tests.security.test_cors_security.TestCORSValidation" name="test_validate_origin_format[https://-False]" time="0.002" /><testcase classname="tests.security.test_cors_security.TestCORSValidation" name="test_get_safe_cors_origins_filters_invalid" time="0.007" /><testcase classname="tests.security.test_cors_security.TestCORSMiddlewareIntegration" name="test_allowed_origin_access" time="0.029" /><testcase classname="tests.security.test_cors_security.TestCORSMiddlewareIntegration" name="test_disallowed_origin_blocked" time="0.013" /><testcase classname="tests.security.test_cors_security.TestCORSMiddlewareIntegration" name="test_preflight_request_handling" time="0.012" /><testcase classname="tests.security.test_cors_security.TestCORSMiddlewareIntegration" name="test_credentials_handling_development" time="0.012" /><testcase classname="tests.security.test_cors_security.TestCORSMiddlewareIntegration" name="test_credentials_handling_testing" time="0.012" /><testcase classname="tests.security.test_cors_security.TestCORSSecurityScenarios" name="test_malicious_origin_attempt" time="0.012" /><testcase classname="tests.security.test_cors_security.TestCORSSecurityScenarios" name="test_subdomain_security" time="0.011" /><testcase classname="tests.security.test_cors_security.TestCORSSecurityScenarios" name="test_case_sensitivity" time="0.012" /><testcase classname="tests.security.test_cors_security.TestCORSConfigurationLogging" name="test_security_info_logging" time="0.008" /><testcase classname="tests.security.test_cors_security.TestCORSConfigurationLogging" name="test_development_origin_logging" time="0.007" /><testcase classname="tests.security.test_cors_security.TestCORSConfigurationLogging" name="test_production_validation_error_logging" time="0.005" /><testcase classname="tests.security.test_cors_security.TestCORSIntegrationWithMainApp" name="test_cors_config_function_integration" time="0.006" /><testcase classname="tests.security.test_cors_security.TestCORSIntegrationWithMainApp" name="test_multiple_cors_config_instances_consistency" time="0.007" /><testcase classname="tests.security.test_cors_security.TestCORSIntegrationWithMainApp" name="test_environment_override" time="0.010" /><testcase classname="tests.security.test_sql_injection_prevention.TestSQLInjectionPrevention" name="test_secure_sort_by_validation_valid_fields" time="0.004" /><testcase classname="tests.security.test_sql_injection_prevention.TestSQLInjectionPrevention" name="test_sql_injection_attempt_in_sort_by_blocked" time="0.004" /><testcase classname="tests.security.test_sql_injection_prevention.TestSQLInjectionPrevention" name="test_sql_injection_attempt_in_sort_order_blocked" time="0.004" /><testcase classname="tests.security.test_sql_injection_prevention.TestSQLInjectionPrevention" name="test_case_insensitive_sort_field_validation" time="0.003" /><testcase classname="tests.security.test_sql_injection_prevention.TestSQLInjectionPrevention" name="test_pydantic_model_injection_prevention" time="0.009" /><testcase classname="tests.security.test_sql_injection_prevention.TestSQLInjectionPrevention" name="test_enum_validation_prevents_injection" time="0.002" /><testcase classname="tests.security.test_sql_injection_prevention.TestSQLInjectionPrevention" name="test_parameter_limits_prevent_resource_exhaustion" time="0.002" /><testcase classname="tests.security.test_sql_injection_prevention.TestSQLInjectionPrevention" name="test_repository_logging_for_security_audit" time="0.004" /><testcase classname="tests.security.test_sql_injection_prevention.TestSQLInjectionPrevention" name="test_whitelist_dictionary_completeness" time="0.004" /><testcase classname="tests.security.test_sql_injection_prevention.TestSQLInjectionPrevention" name="test_end_to_end_injection_prevention" time="0.002" /><testcase classname="tests.security.test_sql_injection_prevention.TestSQLInjectionPrevention" name="test_database_error_handling_prevents_information_leakage" time="0.003" /><testcase classname="tests.security.test_performance_impact.TestSecurityPerformanceImpact" name="test_whitelist_validation_performance" time="0.024"><failure message="AssertionError: Maximum execution time too high: 0.0098s&#10;assert 0.009843499999988126 &lt; 0.002">tests\security\test_performance_impact.py:55: in test_whitelist_validation_performance
    assert max_time &lt; 0.002, f"Maximum execution time too high: {max_time:.4f}s"
E   AssertionError: Maximum execution time too high: 0.0098s
E   assert 0.009843499999988126 &lt; 0.002</failure></testcase><testcase classname="tests.security.test_security_regression.TestSecurityRegression" name="test_no_sql_injection_regression" time="0.003"><error message="failed on setup with &quot;ModuleNotFoundError: No module named 'backend.main'&quot;">tests\security\test_security_regression.py:92: in client
    from backend.main import app
E   ModuleNotFoundError: No module named 'backend.main'</error></testcase><testcase classname="tests.security.test_xss_protection.TestXSSProtection" name="test_basic_xss_prevention" time="0.003"><error message="failed on setup with &quot;ModuleNotFoundError: No module named 'backend.main'&quot;">tests\security\test_xss_protection.py:30: in client
    from backend.main import app
E   ModuleNotFoundError: No module named 'backend.main'</error></testcase><testcase classname="tests.security.test_security_regression.TestSecurityRegression" name="test_no_xss_regression" time="0.002"><error message="failed on setup with &quot;ModuleNotFoundError: No module named 'backend.main'&quot;">tests\security\test_security_regression.py:92: in client
    from backend.main import app
E   ModuleNotFoundError: No module named 'backend.main'</error></testcase><testcase classname="tests.security.test_rate_limiting_ddos.TestRateLimiting" name="test_basic_rate_limiting" time="0.003"><error message="failed on setup with &quot;ModuleNotFoundError: No module named 'backend.main'&quot;">tests\security\test_rate_limiting_ddos.py:29: in client
    from backend.main import app
E   ModuleNotFoundError: No module named 'backend.main'</error></testcase><testcase classname="tests.security.test_validation_security.TestSecurityValidation" name="test_xss_detection" time="0.003" /><testcase classname="tests.security.test_xss_protection.TestXSSProtection" name="test_stored_xss_prevention" time="0.002"><error message="failed on setup with &quot;ModuleNotFoundError: No module named 'backend.main'&quot;">tests\security\test_xss_protection.py:30: in client
    from backend.main import app
E   ModuleNotFoundError: No module named 'backend.main'</error></testcase><testcase classname="tests.security.test_input_validation_comprehensive.TestInputValidationSecurity" name="test_sql_injection_input_validation" time="0.003"><error message="failed on setup with &quot;ModuleNotFoundError: No module named 'backend.main'&quot;">tests\security\test_input_validation_comprehensive.py:28: in client
    from backend.main import app
E   ModuleNotFoundError: No module named 'backend.main'</error></testcase><testcase classname="tests.security.test_validation_security.TestSecurityValidation" name="test_html_sanitization" time="0.004"><failure message="assert ('&amp;lt;a href=&quot;Link&amp;lt;/a&amp;gt;' in '&amp;lt;a href=&amp;quot;alert(1)&amp;quot;&amp;gt;Link&amp;lt;/a&amp;gt;' or '&amp;lt;a href=&amp;...ink&amp;lt;/a&amp;gt;' == '&amp;lt;a href=&quot;Link&amp;lt;/a&amp;gt;'&#10;  &#10;  #x1B[0m#x1B[91m- &amp;lt;a href=&quot;Link&amp;lt;/a&amp;gt;#x1B[39;49;00m#x1B[90m#x1B[39;49;00m&#10;  #x1B[92m+ &amp;lt;a href=&amp;quot;alert(1)&amp;quot;&amp;gt;Link&amp;lt;/a&amp;gt;#x1B[39;49;00m#x1B[90m#x1B[39;49;00m)">tests\security\test_validation_security.py:76: in test_html_sanitization
    assert expected_output in result or result == expected_output
E   assert ('&amp;lt;a href="Link&amp;lt;/a&amp;gt;' in '&amp;lt;a href=&amp;quot;alert(1)&amp;quot;&amp;gt;Link&amp;lt;/a&amp;gt;' or '&amp;lt;a href=&amp;...ink&amp;lt;/a&amp;gt;' == '&amp;lt;a href="Link&amp;lt;/a&amp;gt;'
E     
E     #x1B[0m#x1B[91m- &amp;lt;a href="Link&amp;lt;/a&amp;gt;#x1B[39;49;00m#x1B[90m#x1B[39;49;00m
E     #x1B[92m+ &amp;lt;a href=&amp;quot;alert(1)&amp;quot;&amp;gt;Link&amp;lt;/a&amp;gt;#x1B[39;49;00m#x1B[90m#x1B[39;49;00m)</failure></testcase><testcase classname="tests.security.test_security_regression.TestSecurityRegression" name="test_security_headers_present" time="0.002"><error message="failed on setup with &quot;ModuleNotFoundError: No module named 'backend.main'&quot;">tests\security\test_security_regression.py:92: in client
    from backend.main import app
E   ModuleNotFoundError: No module named 'backend.main'</error></testcase><testcase classname="tests.security.test_validation_security.TestSecurityValidation" name="test_filename_validation" time="0.002"><failure message="Failed: DID NOT RAISE &lt;class 'backend.api.models.SecurityValidationError'&gt;">tests\security\test_validation_security.py:102: in test_filename_validation
    with pytest.raises(SecurityValidationError):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE &lt;class 'backend.api.models.SecurityValidationError'&gt;</failure></testcase><testcase classname="tests.security.test_rate_limiting_ddos.TestRateLimiting" name="test_per_endpoint_rate_limits" time="0.002"><error message="failed on setup with &quot;ModuleNotFoundError: No module named 'backend.main'&quot;">tests\security\test_rate_limiting_ddos.py:29: in client
    from backend.main import app
E   ModuleNotFoundError: No module named 'backend.main'</error></testcase><testcase classname="tests.security.test_xss_protection.TestXSSProtection" name="test_dom_based_xss_prevention" time="0.001"><error message="failed on setup with &quot;ModuleNotFoundError: No module named 'backend.main'&quot;">tests\security\test_xss_protection.py:30: in client
    from backend.main import app
E   ModuleNotFoundError: No module named 'backend.main'</error></testcase><testcase classname="tests.security.test_input_validation_comprehensive.TestInputValidationSecurity" name="test_command_injection_validation" time="0.003"><error message="failed on setup with &quot;ModuleNotFoundError: No module named 'backend.main'&quot;">tests\security\test_input_validation_comprehensive.py:28: in client
    from backend.main import app
E   ModuleNotFoundError: No module named 'backend.main'</error></testcase><testcase classname="tests.security.test_validation_security.TestSecurityValidation" name="test_file_content_type_validation" time="0.002" /><testcase classname="tests.security.test_validation_security.TestDocumentQueryParams" name="test_valid_search_query" time="0.002" /><testcase classname="tests.security.test_security_regression.TestSecurityRegression" name="test_rate_limits_enforced" time="0.002"><error message="failed on setup with &quot;ModuleNotFoundError: No module named 'backend.main'&quot;">tests\security\test_security_regression.py:92: in client
    from backend.main import app
E   ModuleNotFoundError: No module named 'backend.main'</error></testcase><testcase classname="tests.security.test_validation_security.TestDocumentQueryParams" name="test_sql_injection_in_search_query" time="0.002"><failure message="Failed: DID NOT RAISE any of (&lt;class 'backend.api.models.SecurityValidationError'&gt;, &lt;class 'pydantic_core._pydantic_core.ValidationError'&gt;)">tests\security\test_validation_security.py:145: in test_sql_injection_in_search_query
    with pytest.raises((SecurityValidationError, ValidationError)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (&lt;class 'backend.api.models.SecurityValidationError'&gt;, &lt;class 'pydantic_core._pydantic_core.ValidationError'&gt;)</failure></testcase><testcase classname="tests.security.test_rate_limiting_ddos.TestRateLimiting" name="test_user_based_rate_limiting" time="0.001"><error message="failed on setup with &quot;ModuleNotFoundError: No module named 'backend.main'&quot;">tests\security\test_rate_limiting_ddos.py:29: in client
    from backend.main import app
E   ModuleNotFoundError: No module named 'backend.main'</error></testcase><testcase classname="tests.security.test_input_validation_comprehensive.TestInputValidationSecurity" name="test_path_traversal_validation" time="0.002"><error message="failed on setup with &quot;ModuleNotFoundError: No module named 'backend.main'&quot;">tests\security\test_input_validation_comprehensive.py:28: in client
    from backend.main import app
E   ModuleNotFoundError: No module named 'backend.main'</error></testcase><testcase classname="tests.security.test_xss_protection.TestXSSProtection" name="test_reflected_xss_prevention" time="0.002"><error message="failed on setup with &quot;ModuleNotFoundError: No module named 'backend.main'&quot;">tests\security\test_xss_protection.py:30: in client
    from backend.main import app
E   ModuleNotFoundError: No module named 'backend.main'</error></testcase><testcase classname="tests.security.test_security_regression.TestSecurityRegression" name="test_input_validation_active" time="0.002"><error message="failed on setup with &quot;ModuleNotFoundError: No module named 'backend.main'&quot;">tests\security\test_security_regression.py:92: in client
    from backend.main import app
E   ModuleNotFoundError: No module named 'backend.main'</error></testcase><testcase classname="tests.security.test_validation_security.TestDocumentQueryParams" name="test_xss_in_search_query" time="0.002" /><testcase classname="tests.security.test_validation_security.TestDocumentQueryParams" name="test_search_query_length_limit" time="0.002" /><testcase classname="tests.security.test_validation_security.TestDocumentModels" name="test_valid_document_creation" time="0.002" /><testcase classname="tests.security.test_xss_protection.TestXSSProtection" name="test_xss_in_json_responses" time="0.002"><error message="failed on setup with &quot;ModuleNotFoundError: No module named 'backend.main'&quot;">tests\security\test_xss_protection.py:30: in client
    from backend.main import app
E   ModuleNotFoundError: No module named 'backend.main'</error></testcase><testcase classname="tests.security.test_validation_security.TestDocumentModels" name="test_title_sql_injection" time="0.003" /><testcase classname="tests.security.test_rate_limiting_ddos.TestRateLimiting" name="test_ip_based_rate_limiting" time="0.002"><error message="failed on setup with &quot;ModuleNotFoundError: No module named 'backend.main'&quot;">tests\security\test_rate_limiting_ddos.py:29: in client
    from backend.main import app
E   ModuleNotFoundError: No module named 'backend.main'</error></testcase><testcase classname="tests.security.test_input_validation_comprehensive.TestInputValidationSecurity" name="test_integer_overflow_validation" time="0.002"><error message="failed on setup with &quot;ModuleNotFoundError: No module named 'backend.main'&quot;">tests\security\test_input_validation_comprehensive.py:28: in client
    from backend.main import app
E   ModuleNotFoundError: No module named 'backend.main'</error></testcase><testcase classname="tests.security.test_validation_security.TestDocumentModels" name="test_title_xss_prevention" time="0.002" /><testcase classname="tests.security.test_validation_security.TestDocumentModels" name="test_metadata_validation" time="0.002" /><testcase classname="tests.security.test_validation_security.TestDocumentModels" name="test_file_size_limits" time="0.002" /><testcase classname="tests.security.test_validation_security.TestRAGQueryRequest" name="test_valid_rag_query" time="0.003" /><testcase classname="tests.security.test_input_validation_comprehensive.TestInputValidationSecurity" name="test_string_length_validation" time="0.003"><error message="failed on setup with &quot;ModuleNotFoundError: No module named 'backend.main'&quot;">tests\security\test_input_validation_comprehensive.py:28: in client
    from backend.main import app
E   ModuleNotFoundError: No module named 'backend.main'</error></testcase><testcase classname="tests.security.test_validation_security.TestRAGQueryRequest" name="test_prompt_injection_detection" time="0.003"><failure message="Failed: DID NOT RAISE any of (&lt;class 'backend.api.models.SecurityValidationError'&gt;, &lt;class 'pydantic_core._pydantic_core.ValidationError'&gt;)">tests\security\test_validation_security.py:274: in test_prompt_injection_detection
    with pytest.raises((SecurityValidationError, ValidationError)):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE any of (&lt;class 'backend.api.models.SecurityValidationError'&gt;, &lt;class 'pydantic_core._pydantic_core.ValidationError'&gt;)</failure></testcase><testcase classname="tests.security.test_rate_limiting_ddos.TestRateLimiting" name="test_sliding_window_rate_limiting" time="0.002"><error message="failed on setup with &quot;ModuleNotFoundError: No module named 'backend.main'&quot;">tests\security\test_rate_limiting_ddos.py:29: in client
    from backend.main import app
E   ModuleNotFoundError: No module named 'backend.main'</error></testcase><testcase classname="tests.security.test_performance_impact.TestSecurityPerformanceImpact" name="test_pydantic_validation_performance" time="0.132"><failure message="AssertionError: Maximum validation time too high: 0.001698s&#10;assert 0.0016981999997369712 &lt; 0.001">tests\security\test_performance_impact.py:83: in test_pydantic_validation_performance
    assert max_time &lt; 0.001, f"Maximum validation time too high: {max_time:.6f}s"
E   AssertionError: Maximum validation time too high: 0.001698s
E   assert 0.0016981999997369712 &lt; 0.001</failure></testcase><testcase classname="tests.security.test_performance_impact.TestSecurityPerformanceImpact" name="test_enum_validation_performance" time="0.013" /><testcase classname="tests.security.test_performance_impact.TestSecurityPerformanceImpact" name="test_search_pattern_detection_performance" time="0.919"><failure message="AssertionError: Pattern detection too slow: 0.000182s&#10;assert 0.00018181628001293575 &lt; 0.0001">tests\security\test_performance_impact.py:134: in test_search_pattern_detection_performance
    assert avg_time &lt; 0.0001, f"Pattern detection too slow: {avg_time:.6f}s"
E   AssertionError: Pattern detection too slow: 0.000182s
E   assert 0.00018181628001293575 &lt; 0.0001</failure></testcase><testcase classname="tests.security.test_performance_impact.TestSecurityPerformanceImpact" name="test_malicious_pattern_detection_performance" time="0.054" /><testcase classname="tests.security.test_performance_impact.TestSecurityPerformanceImpact" name="test_memory_usage_validation" time="0.253" /><testcase classname="tests.security.test_performance_impact.TestSecurityPerformanceImpact" name="test_repository_security_benchmark" time="1.449" /><testcase classname="tests.security.test_performance_impact.TestSecurityPerformanceImpact" name="test_pydantic_validation_benchmark" time="0.570" /><testcase classname="tests.security.test_cors_api_integration.TestCORSAPIIntegration" name="test_production_cors_blocks_localhost" time="0.021"><failure message="assert ('Access-Control-Allow-Origin' not in Headers({'content-length': '193', 'content-type': 'application/json', 'content-security-policy-report-only': &quot;default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' http://localhost:* http://127.0.0.1:* https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net; img-src 'self' data: blob: http://localhost:* http://127.0.0.1:*; font-src 'self' data: https://fonts.gstatic.com; connect-src 'self' http://localhost:* http://127.0.0.1:* ws://localhost:* ws://127.0.0.1:* https://*.googleapis.com; frame-ancestors 'none'; base-uri 'self'; form-action 'self'; report-uri /api/security/csp-report&quot;, 'x-frame-options': 'DENY', 'x-content-type-options': 'nosniff', 'x-xss-protection': '1; mode=block', 'referrer-policy': 'strict-origin-when-cross-origin', 'permissions-policy': 'accelerometer=*, ambient-light-sensor=*, autoplay=*, battery=*, camera=(self), display-capture=(self), document-domain=*, encrypted-media=*, fullscreen=*, geolocation=(self), gyroscope=*, magnetometer=*, microphone=(self), midi=*, payment=(self), picture-in-picture=*, publickey-credentials-get=(self), screen-wake-lock=*, sync-xhr=*, usb=(self), web-share=(self), xr-spatial-tracking=(self)', 'cross-origin-embedder-policy': 'unsafe-none', 'cross-origin-opener-policy': 'same-origin-allow-popups', 'cross-origin-resource-policy': 'same-site', 'report-to': '[{&quot;group&quot;: &quot;csp-endpoint&quot;, &quot;max_age&quot;: 86400, &quot;endpoints&quot;: [{&quot;url&quot;: &quot;/api/security/csp-report&quot;}], &quot;include_subdomains&quot;: true}]', 'x-api-version': '2.0.0', 'x-request-id': 'fb4e2f0340150a02c925ca10379369b5', 'x-ratelimit-limit': '100000', 'x-ratelimit-remaining': '99998', 'x-ratelimit-reset': '1754715570', 'access-control-allow-credentials': 'true', 'access-control-expose-headers': 'X-Total-Count, X-Request-ID', 'access-control-allow-origin': 'http://localhost:3000', 'vary': 'Origin'}) or 'http://localhost:3000' != 'http://localhost:3000')&#10; +  where Headers({'content-length': '193', 'content-type': 'application/json', 'content-security-policy-report-only': &quot;default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' http://localhost:* http://127.0.0.1:* https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net; img-src 'self' data: blob: http://localhost:* http://127.0.0.1:*; font-src 'self' data: https://fonts.gstatic.com; connect-src 'self' http://localhost:* http://127.0.0.1:* ws://localhost:* ws://127.0.0.1:* https://*.googleapis.com; frame-ancestors 'none'; base-uri 'self'; form-action 'self'; report-uri /api/security/csp-report&quot;, 'x-frame-options': 'DENY', 'x-content-type-options': 'nosniff', 'x-xss-protection': '1; mode=block', 'referrer-policy': 'strict-origin-when-cross-origin', 'permissions-policy': 'accelerometer=*, ambient-light-sensor=*, autoplay=*, battery=*, camera=(self), display-capture=(self), document-domain=*, encrypted-media=*, fullscreen=*, geolocation=(self), gyroscope=*, magnetometer=*, microphone=(self), midi=*, payment=(self), picture-in-picture=*, publickey-credentials-get=(self), screen-wake-lock=*, sync-xhr=*, usb=(self), web-share=(self), xr-spatial-tracking=(self)', 'cross-origin-embedder-policy': 'unsafe-none', 'cross-origin-opener-policy': 'same-origin-allow-popups', 'cross-origin-resource-policy': 'same-site', 'report-to': '[{&quot;group&quot;: &quot;csp-endpoint&quot;, &quot;max_age&quot;: 86400, &quot;endpoints&quot;: [{&quot;url&quot;: &quot;/api/security/csp-report&quot;}], &quot;include_subdomains&quot;: true}]', 'x-api-version': '2.0.0', 'x-request-id': 'fb4e2f0340150a02c925ca10379369b5', 'x-ratelimit-limit': '100000', 'x-ratelimit-remaining': '99998', 'x-ratelimit-reset': '1754715570', 'access-control-allow-credentials': 'true', 'access-control-expose-headers': 'X-Total-Count, X-Request-ID', 'access-control-allow-origin': 'http://localhost:3000', 'vary': 'Origin'}) = &lt;Response [200 OK]&gt;.headers&#10; +  and   'http://localhost:3000' = get('Access-Control-Allow-Origin')&#10; +    where get = Headers({'content-length': '193', 'content-type': 'application/json', 'content-security-policy-report-only': &quot;default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' http://localhost:* http://127.0.0.1:* https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net; img-src 'self' data: blob: http://localhost:* http://127.0.0.1:*; font-src 'self' data: https://fonts.gstatic.com; connect-src 'self' http://localhost:* http://127.0.0.1:* ws://localhost:* ws://127.0.0.1:* https://*.googleapis.com; frame-ancestors 'none'; base-uri 'self'; form-action 'self'; report-uri /api/security/csp-report&quot;, 'x-frame-options': 'DENY', 'x-content-type-options': 'nosniff', 'x-xss-protection': '1; mode=block', 'referrer-policy': 'strict-origin-when-cross-origin', 'permissions-policy': 'accelerometer=*, ambient-light-sensor=*, autoplay=*, battery=*, camera=(self), display-capture=(self), document-domain=*, encrypted-media=*, fullscreen=*, geolocation=(self), gyroscope=*, magnetometer=*, microphone=(self), midi=*, payment=(self), picture-in-picture=*, publickey-credentials-get=(self), screen-wake-lock=*, sync-xhr=*, usb=(self), web-share=(self), xr-spatial-tracking=(self)', 'cross-origin-embedder-policy': 'unsafe-none', 'cross-origin-opener-policy': 'same-origin-allow-popups', 'cross-origin-resource-policy': 'same-site', 'report-to': '[{&quot;group&quot;: &quot;csp-endpoint&quot;, &quot;max_age&quot;: 86400, &quot;endpoints&quot;: [{&quot;url&quot;: &quot;/api/security/csp-report&quot;}], &quot;include_subdomains&quot;: true}]', 'x-api-version': '2.0.0', 'x-request-id': 'fb4e2f0340150a02c925ca10379369b5', 'x-ratelimit-limit': '100000', 'x-ratelimit-remaining': '99998', 'x-ratelimit-reset': '1754715570', 'access-control-allow-credentials': 'true', 'access-control-expose-headers': 'X-Total-Count, X-Request-ID', 'access-control-allow-origin': 'http://localhost:3000', 'vary': 'Origin'}).get&#10; +      where Headers({'content-length': '193', 'content-type': 'application/json', 'content-security-policy-report-only': &quot;default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' http://localhost:* http://127.0.0.1:* https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net; img-src 'self' data: blob: http://localhost:* http://127.0.0.1:*; font-src 'self' data: https://fonts.gstatic.com; connect-src 'self' http://localhost:* http://127.0.0.1:* ws://localhost:* ws://127.0.0.1:* https://*.googleapis.com; frame-ancestors 'none'; base-uri 'self'; form-action 'self'; report-uri /api/security/csp-report&quot;, 'x-frame-options': 'DENY', 'x-content-type-options': 'nosniff', 'x-xss-protection': '1; mode=block', 'referrer-policy': 'strict-origin-when-cross-origin', 'permissions-policy': 'accelerometer=*, ambient-light-sensor=*, autoplay=*, battery=*, camera=(self), display-capture=(self), document-domain=*, encrypted-media=*, fullscreen=*, geolocation=(self), gyroscope=*, magnetometer=*, microphone=(self), midi=*, payment=(self), picture-in-picture=*, publickey-credentials-get=(self), screen-wake-lock=*, sync-xhr=*, usb=(self), web-share=(self), xr-spatial-tracking=(self)', 'cross-origin-embedder-policy': 'unsafe-none', 'cross-origin-opener-policy': 'same-origin-allow-popups', 'cross-origin-resource-policy': 'same-site', 'report-to': '[{&quot;group&quot;: &quot;csp-endpoint&quot;, &quot;max_age&quot;: 86400, &quot;endpoints&quot;: [{&quot;url&quot;: &quot;/api/security/csp-report&quot;}], &quot;include_subdomains&quot;: true}]', 'x-api-version': '2.0.0', 'x-request-id': 'fb4e2f0340150a02c925ca10379369b5', 'x-ratelimit-limit': '100000', 'x-ratelimit-remaining': '99998', 'x-ratelimit-reset': '1754715570', 'access-control-allow-credentials': 'true', 'access-control-expose-headers': 'X-Total-Count, X-Request-ID', 'access-control-allow-origin': 'http://localhost:3000', 'vary': 'Origin'}) = &lt;Response [200 OK]&gt;.headers">tests\security\test_cors_api_integration.py:79: in test_production_cors_blocks_localhost
    assert "Access-Control-Allow-Origin" not in response.headers or \
E   assert ('Access-Control-Allow-Origin' not in Headers({'content-length': '193', 'content-type': 'application/json', 'content-security-policy-report-only': "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' http://localhost:* http://127.0.0.1:* https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net; img-src 'self' data: blob: http://localhost:* http://127.0.0.1:*; font-src 'self' data: https://fonts.gstatic.com; connect-src 'self' http://localhost:* http://127.0.0.1:* ws://localhost:* ws://127.0.0.1:* https://*.googleapis.com; frame-ancestors 'none'; base-uri 'self'; form-action 'self'; report-uri /api/security/csp-report", 'x-frame-options': 'DENY', 'x-content-type-options': 'nosniff', 'x-xss-protection': '1; mode=block', 'referrer-policy': 'strict-origin-when-cross-origin', 'permissions-policy': 'accelerometer=*, ambient-light-sensor=*, autoplay=*, battery=*, camera=(self), display-capture=(self), document-domain=*, encrypted-media=*, fullscreen=*, geolocation=(self), gyroscope=*, magnetometer=*, microphone=(self), midi=*, payment=(self), picture-in-picture=*, publickey-credentials-get=(self), screen-wake-lock=*, sync-xhr=*, usb=(self), web-share=(self), xr-spatial-tracking=(self)', 'cross-origin-embedder-policy': 'unsafe-none', 'cross-origin-opener-policy': 'same-origin-allow-popups', 'cross-origin-resource-policy': 'same-site', 'report-to': '[{"group": "csp-endpoint", "max_age": 86400, "endpoints": [{"url": "/api/security/csp-report"}], "include_subdomains": true}]', 'x-api-version': '2.0.0', 'x-request-id': 'fb4e2f0340150a02c925ca10379369b5', 'x-ratelimit-limit': '100000', 'x-ratelimit-remaining': '99998', 'x-ratelimit-reset': '1754715570', 'access-control-allow-credentials': 'true', 'access-control-expose-headers': 'X-Total-Count, X-Request-ID', 'access-control-allow-origin': 'http://localhost:3000', 'vary': 'Origin'}) or 'http://localhost:3000' != 'http://localhost:3000')
E    +  where Headers({'content-length': '193', 'content-type': 'application/json', 'content-security-policy-report-only': "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' http://localhost:* http://127.0.0.1:* https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net; img-src 'self' data: blob: http://localhost:* http://127.0.0.1:*; font-src 'self' data: https://fonts.gstatic.com; connect-src 'self' http://localhost:* http://127.0.0.1:* ws://localhost:* ws://127.0.0.1:* https://*.googleapis.com; frame-ancestors 'none'; base-uri 'self'; form-action 'self'; report-uri /api/security/csp-report", 'x-frame-options': 'DENY', 'x-content-type-options': 'nosniff', 'x-xss-protection': '1; mode=block', 'referrer-policy': 'strict-origin-when-cross-origin', 'permissions-policy': 'accelerometer=*, ambient-light-sensor=*, autoplay=*, battery=*, camera=(self), display-capture=(self), document-domain=*, encrypted-media=*, fullscreen=*, geolocation=(self), gyroscope=*, magnetometer=*, microphone=(self), midi=*, payment=(self), picture-in-picture=*, publickey-credentials-get=(self), screen-wake-lock=*, sync-xhr=*, usb=(self), web-share=(self), xr-spatial-tracking=(self)', 'cross-origin-embedder-policy': 'unsafe-none', 'cross-origin-opener-policy': 'same-origin-allow-popups', 'cross-origin-resource-policy': 'same-site', 'report-to': '[{"group": "csp-endpoint", "max_age": 86400, "endpoints": [{"url": "/api/security/csp-report"}], "include_subdomains": true}]', 'x-api-version': '2.0.0', 'x-request-id': 'fb4e2f0340150a02c925ca10379369b5', 'x-ratelimit-limit': '100000', 'x-ratelimit-remaining': '99998', 'x-ratelimit-reset': '1754715570', 'access-control-allow-credentials': 'true', 'access-control-expose-headers': 'X-Total-Count, X-Request-ID', 'access-control-allow-origin': 'http://localhost:3000', 'vary': 'Origin'}) = &lt;Response [200 OK]&gt;.headers
E    +  and   'http://localhost:3000' = get('Access-Control-Allow-Origin')
E    +    where get = Headers({'content-length': '193', 'content-type': 'application/json', 'content-security-policy-report-only': "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' http://localhost:* http://127.0.0.1:* https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net; img-src 'self' data: blob: http://localhost:* http://127.0.0.1:*; font-src 'self' data: https://fonts.gstatic.com; connect-src 'self' http://localhost:* http://127.0.0.1:* ws://localhost:* ws://127.0.0.1:* https://*.googleapis.com; frame-ancestors 'none'; base-uri 'self'; form-action 'self'; report-uri /api/security/csp-report", 'x-frame-options': 'DENY', 'x-content-type-options': 'nosniff', 'x-xss-protection': '1; mode=block', 'referrer-policy': 'strict-origin-when-cross-origin', 'permissions-policy': 'accelerometer=*, ambient-light-sensor=*, autoplay=*, battery=*, camera=(self), display-capture=(self), document-domain=*, encrypted-media=*, fullscreen=*, geolocation=(self), gyroscope=*, magnetometer=*, microphone=(self), midi=*, payment=(self), picture-in-picture=*, publickey-credentials-get=(self), screen-wake-lock=*, sync-xhr=*, usb=(self), web-share=(self), xr-spatial-tracking=(self)', 'cross-origin-embedder-policy': 'unsafe-none', 'cross-origin-opener-policy': 'same-origin-allow-popups', 'cross-origin-resource-policy': 'same-site', 'report-to': '[{"group": "csp-endpoint", "max_age": 86400, "endpoints": [{"url": "/api/security/csp-report"}], "include_subdomains": true}]', 'x-api-version': '2.0.0', 'x-request-id': 'fb4e2f0340150a02c925ca10379369b5', 'x-ratelimit-limit': '100000', 'x-ratelimit-remaining': '99998', 'x-ratelimit-reset': '1754715570', 'access-control-allow-credentials': 'true', 'access-control-expose-headers': 'X-Total-Count, X-Request-ID', 'access-control-allow-origin': 'http://localhost:3000', 'vary': 'Origin'}).get
E    +      where Headers({'content-length': '193', 'content-type': 'application/json', 'content-security-policy-report-only': "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' http://localhost:* http://127.0.0.1:* https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net; img-src 'self' data: blob: http://localhost:* http://127.0.0.1:*; font-src 'self' data: https://fonts.gstatic.com; connect-src 'self' http://localhost:* http://127.0.0.1:* ws://localhost:* ws://127.0.0.1:* https://*.googleapis.com; frame-ancestors 'none'; base-uri 'self'; form-action 'self'; report-uri /api/security/csp-report", 'x-frame-options': 'DENY', 'x-content-type-options': 'nosniff', 'x-xss-protection': '1; mode=block', 'referrer-policy': 'strict-origin-when-cross-origin', 'permissions-policy': 'accelerometer=*, ambient-light-sensor=*, autoplay=*, battery=*, camera=(self), display-capture=(self), document-domain=*, encrypted-media=*, fullscreen=*, geolocation=(self), gyroscope=*, magnetometer=*, microphone=(self), midi=*, payment=(self), picture-in-picture=*, publickey-credentials-get=(self), screen-wake-lock=*, sync-xhr=*, usb=(self), web-share=(self), xr-spatial-tracking=(self)', 'cross-origin-embedder-policy': 'unsafe-none', 'cross-origin-opener-policy': 'same-origin-allow-popups', 'cross-origin-resource-policy': 'same-site', 'report-to': '[{"group": "csp-endpoint", "max_age": 86400, "endpoints": [{"url": "/api/security/csp-report"}], "include_subdomains": true}]', 'x-api-version': '2.0.0', 'x-request-id': 'fb4e2f0340150a02c925ca10379369b5', 'x-ratelimit-limit': '100000', 'x-ratelimit-remaining': '99998', 'x-ratelimit-reset': '1754715570', 'access-control-allow-credentials': 'true', 'access-control-expose-headers': 'X-Total-Count, X-Request-ID', 'access-control-allow-origin': 'http://localhost:3000', 'vary': 'Origin'}) = &lt;Response [200 OK]&gt;.headers</failure></testcase><testcase classname="tests.security.test_api_security_integration.TestAPISecurityIntegration" name="test_sql_injection_in_sort_by_rejected" time="0.058" /><testcase classname="tests.security.test_api_security_integration.TestAPISecurityIntegration" name="test_sql_injection_in_sort_order_rejected" time="0.045" /><testcase classname="tests.security.test_api_security_integration.TestAPISecurityIntegration" name="test_dangerous_search_query_rejected" time="0.029"><failure message="pydantic_core._pydantic_core.ValidationError: 1 validation error for DocumentQueryParams&#10;search_query&#10;  Value error, Security validation failed for field 'search_query': Contains potentially dangerous pattern: --[\s]* [type=value_error, input_value=&quot;search'; DROP TABLE documents; --&quot;, input_type=str]&#10;    For further information visit https://errors.pydantic.dev/2.11/v/value_error">tests\security\test_api_security_integration.py:110: in test_dangerous_search_query_rejected
    response = client.get("/documents/", params={
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\starlette\testclient.py:479: in get
    return super().get(
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\httpx\_client.py:1053: in get
    return self.request(
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\starlette\testclient.py:451: in request
    return super().request(
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\httpx\_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\httpx\_client.py:914: in send
    response = self._send_handling_auth(
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\httpx\_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\httpx\_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\httpx\_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\starlette\testclient.py:354: in handle_request
    raise exc
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\starlette\testclient.py:351: in handle_request
    portal.call(self.app, scope, receive, send)
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\anyio\from_thread.py:290: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\ProgramData\miniconda3\Lib\concurrent\futures\_base.py:456: in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
C:\ProgramData\miniconda3\Lib\concurrent\futures\_base.py:401: in __get_result
    raise self._exception
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\anyio\from_thread.py:221: in _call_func
    retval = await retval_or_awaitable
             ^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\fastapi\applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\starlette\applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py:186: in __call__
    raise exc
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py:164: in __call__
    await self.app(scope, receive, _send)
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py:736: in app
    await route.handle(scope, receive, send)
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py:290: in handle
    await self.app(scope, receive, send)
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py:78: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py:75: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py:292: in app
    solved_result = await solve_dependencies(
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\fastapi\dependencies\utils.py:640: in solve_dependencies
    solved = await run_in_threadpool(call, **solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\starlette\concurrency.py:38: in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\anyio\to_thread.py:56: in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\anyio\_backends\_asyncio.py:2470: in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
C:\Users\k7407\AppData\Roaming\Python\Python313\site-packages\anyio\_backends\_asyncio.py:967: in run
    result = context.run(func, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^
E   pydantic_core._pydantic_core.ValidationError: 1 validation error for DocumentQueryParams
E   search_query
E     Value error, Security validation failed for field 'search_query': Contains potentially dangerous pattern: --[\s]* [type=value_error, input_value="search'; DROP TABLE documents; --", input_type=str]
E       For further information visit https://errors.pydantic.dev/2.11/v/value_error</failure></testcase><testcase classname="tests.security.test_performance_impact.TestSecurityPerformanceImpact" name="test_concurrent_validation_performance" time="0.122" /><testcase classname="tests.security.test_cors_api_integration.TestCORSAPIIntegration" name="test_cors_preflight_document_api" time="0.011" /><testcase classname="tests.security.test_cors_api_integration.TestCORSAPIIntegration" name="test_cors_rag_api_endpoints" time="0.025" /><testcase classname="tests.security.test_cors_api_integration.TestCORSAPIIntegration" name="test_cors_library_api_endpoints" time="0.041" /><testcase classname="tests.security.test_cors_api_integration.TestCORSAPIIntegration" name="test_cors_websocket_origin_validation" time="0.015"><failure message="assert 404 in [426, 400]&#10; +  where 404 = &lt;Response [404 Not Found]&gt;.status_code">tests\security\test_cors_api_integration.py:150: in test_cors_websocket_origin_validation
    assert response.status_code in [426, 400]  # Upgrade required or bad request
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   assert 404 in [426, 400]
E    +  where 404 = &lt;Response [404 Not Found]&gt;.status_code</failure></testcase><testcase classname="tests.security.test_cors_api_integration.TestCORSAPIIntegration" name="test_multiple_allowed_origins" time="0.040"><failure message="assert 'Access-Control-Allow-Origin' in Headers({'content-length': '193', 'content-type': 'application/json', 'content-security-policy-report-only': &quot;default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' http://localhost:* http://127.0.0.1:* https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net; img-src 'self' data: blob: http://localhost:* http://127.0.0.1:*; font-src 'self' data: https://fonts.gstatic.com; connect-src 'self' http://localhost:* http://127.0.0.1:* ws://localhost:* ws://127.0.0.1:* https://*.googleapis.com; frame-ancestors 'none'; base-uri 'self'; form-action 'self'; report-uri /api/security/csp-report&quot;, 'x-frame-options': 'DENY', 'x-content-type-options': 'nosniff', 'x-xss-protection': '1; mode=block', 'referrer-policy': 'strict-origin-when-cross-origin', 'permissions-policy': 'accelerometer=*, ambient-light-sensor=*, autoplay=*, battery=*, camera=(self), display-capture=(self), document-domain=*, encrypted-media=*, fullscreen=*, geolocation=(self), gyroscope=*, magnetometer=*, microphone=(self), midi=*, payment=(self), picture-in-picture=*, publickey-credentials-get=(self), screen-wake-lock=*, sync-xhr=*, usb=(self), web-share=(self), xr-spatial-tracking=(self)', 'cross-origin-embedder-policy': 'unsafe-none', 'cross-origin-opener-policy': 'same-origin-allow-popups', 'cross-origin-resource-policy': 'same-site', 'report-to': '[{&quot;group&quot;: &quot;csp-endpoint&quot;, &quot;max_age&quot;: 86400, &quot;endpoints&quot;: [{&quot;url&quot;: &quot;/api/security/csp-report&quot;}], &quot;include_subdomains&quot;: true}]', 'x-api-version': '2.0.0', 'x-request-id': '9e98bc32af847f63bbc9d29c31401f69', 'x-ratelimit-limit': '100000', 'x-ratelimit-remaining': '99995', 'x-ratelimit-reset': '1754715570', 'access-control-allow-credentials': 'true', 'access-control-expose-headers': 'X-Total-Count, X-Request-ID'})&#10; +  where Headers({'content-length': '193', 'content-type': 'application/json', 'content-security-policy-report-only': &quot;default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' http://localhost:* http://127.0.0.1:* https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net; img-src 'self' data: blob: http://localhost:* http://127.0.0.1:*; font-src 'self' data: https://fonts.gstatic.com; connect-src 'self' http://localhost:* http://127.0.0.1:* ws://localhost:* ws://127.0.0.1:* https://*.googleapis.com; frame-ancestors 'none'; base-uri 'self'; form-action 'self'; report-uri /api/security/csp-report&quot;, 'x-frame-options': 'DENY', 'x-content-type-options': 'nosniff', 'x-xss-protection': '1; mode=block', 'referrer-policy': 'strict-origin-when-cross-origin', 'permissions-policy': 'accelerometer=*, ambient-light-sensor=*, autoplay=*, battery=*, camera=(self), display-capture=(self), document-domain=*, encrypted-media=*, fullscreen=*, geolocation=(self), gyroscope=*, magnetometer=*, microphone=(self), midi=*, payment=(self), picture-in-picture=*, publickey-credentials-get=(self), screen-wake-lock=*, sync-xhr=*, usb=(self), web-share=(self), xr-spatial-tracking=(self)', 'cross-origin-embedder-policy': 'unsafe-none', 'cross-origin-opener-policy': 'same-origin-allow-popups', 'cross-origin-resource-policy': 'same-site', 'report-to': '[{&quot;group&quot;: &quot;csp-endpoint&quot;, &quot;max_age&quot;: 86400, &quot;endpoints&quot;: [{&quot;url&quot;: &quot;/api/security/csp-report&quot;}], &quot;include_subdomains&quot;: true}]', 'x-api-version': '2.0.0', 'x-request-id': '9e98bc32af847f63bbc9d29c31401f69', 'x-ratelimit-limit': '100000', 'x-ratelimit-remaining': '99995', 'x-ratelimit-reset': '1754715570', 'access-control-allow-credentials': 'true', 'access-control-expose-headers': 'X-Total-Count, X-Request-ID'}) = &lt;Response [200 OK]&gt;.headers">tests\security\test_cors_api_integration.py:170: in test_multiple_allowed_origins
    assert "Access-Control-Allow-Origin" in response.headers
E   assert 'Access-Control-Allow-Origin' in Headers({'content-length': '193', 'content-type': 'application/json', 'content-security-policy-report-only': "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' http://localhost:* http://127.0.0.1:* https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net; img-src 'self' data: blob: http://localhost:* http://127.0.0.1:*; font-src 'self' data: https://fonts.gstatic.com; connect-src 'self' http://localhost:* http://127.0.0.1:* ws://localhost:* ws://127.0.0.1:* https://*.googleapis.com; frame-ancestors 'none'; base-uri 'self'; form-action 'self'; report-uri /api/security/csp-report", 'x-frame-options': 'DENY', 'x-content-type-options': 'nosniff', 'x-xss-protection': '1; mode=block', 'referrer-policy': 'strict-origin-when-cross-origin', 'permissions-policy': 'accelerometer=*, ambient-light-sensor=*, autoplay=*, battery=*, camera=(self), display-capture=(self), document-domain=*, encrypted-media=*, fullscreen=*, geolocation=(self), gyroscope=*, magnetometer=*, microphone=(self), midi=*, payment=(self), picture-in-picture=*, publickey-credentials-get=(self), screen-wake-lock=*, sync-xhr=*, usb=(self), web-share=(self), xr-spatial-tracking=(self)', 'cross-origin-embedder-policy': 'unsafe-none', 'cross-origin-opener-policy': 'same-origin-allow-popups', 'cross-origin-resource-policy': 'same-site', 'report-to': '[{"group": "csp-endpoint", "max_age": 86400, "endpoints": [{"url": "/api/security/csp-report"}], "include_subdomains": true}]', 'x-api-version': '2.0.0', 'x-request-id': '9e98bc32af847f63bbc9d29c31401f69', 'x-ratelimit-limit': '100000', 'x-ratelimit-remaining': '99995', 'x-ratelimit-reset': '1754715570', 'access-control-allow-credentials': 'true', 'access-control-expose-headers': 'X-Total-Count, X-Request-ID'})
E    +  where Headers({'content-length': '193', 'content-type': 'application/json', 'content-security-policy-report-only': "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' http://localhost:* http://127.0.0.1:* https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net; img-src 'self' data: blob: http://localhost:* http://127.0.0.1:*; font-src 'self' data: https://fonts.gstatic.com; connect-src 'self' http://localhost:* http://127.0.0.1:* ws://localhost:* ws://127.0.0.1:* https://*.googleapis.com; frame-ancestors 'none'; base-uri 'self'; form-action 'self'; report-uri /api/security/csp-report", 'x-frame-options': 'DENY', 'x-content-type-options': 'nosniff', 'x-xss-protection': '1; mode=block', 'referrer-policy': 'strict-origin-when-cross-origin', 'permissions-policy': 'accelerometer=*, ambient-light-sensor=*, autoplay=*, battery=*, camera=(self), display-capture=(self), document-domain=*, encrypted-media=*, fullscreen=*, geolocation=(self), gyroscope=*, magnetometer=*, microphone=(self), midi=*, payment=(self), picture-in-picture=*, publickey-credentials-get=(self), screen-wake-lock=*, sync-xhr=*, usb=(self), web-share=(self), xr-spatial-tracking=(self)', 'cross-origin-embedder-policy': 'unsafe-none', 'cross-origin-opener-policy': 'same-origin-allow-popups', 'cross-origin-resource-policy': 'same-site', 'report-to': '[{"group": "csp-endpoint", "max_age": 86400, "endpoints": [{"url": "/api/security/csp-report"}], "include_subdomains": true}]', 'x-api-version': '2.0.0', 'x-request-id': '9e98bc32af847f63bbc9d29c31401f69', 'x-ratelimit-limit': '100000', 'x-ratelimit-remaining': '99995', 'x-ratelimit-reset': '1754715570', 'access-control-allow-credentials': 'true', 'access-control-expose-headers': 'X-Total-Count, X-Request-ID'}) = &lt;Response [200 OK]&gt;.headers</failure></testcase><testcase classname="tests.security.test_cors_api_integration.TestCORSAPIIntegration" name="test_blocked_origin_no_cors_headers" time="0.023" /><testcase classname="tests.security.test_cors_api_integration.TestCORSAPIIntegration" name="test_cors_headers_content_security" time="0.018"><failure message="AssertionError: assert 'Access-Control-Allow-Origin' in ['access-control-allow-credentials', 'access-control-expose-headers']">tests\security\test_cors_api_integration.py:209: in test_cors_headers_content_security
    assert expected in cors_headers
E   AssertionError: assert 'Access-Control-Allow-Origin' in ['access-control-allow-credentials', 'access-control-expose-headers']</failure></testcase><testcase classname="tests.security.test_cors_api_integration.TestCORSAPIIntegration" name="test_cors_method_restrictions" time="0.011" /><testcase classname="tests.security.test_cors_api_integration.TestCORSAPIIntegration" name="test_cors_credentials_environment_specific" time="0.034"><failure message="AssertionError: assert 'true' != 'true'">tests\security\test_cors_api_integration.py:263: in test_cors_credentials_environment_specific
    assert credentials_header != "true"
E   AssertionError: assert 'true' != 'true'</failure></testcase><testcase classname="tests.security.test_api_security_integration.TestAPISecurityIntegration" name="test_parameter_boundary_validation" time="0.055" /><testcase classname="tests.security.test_api_security_integration.TestAPISecurityIntegration" name="test_long_search_query_rejected" time="0.035" /><testcase classname="tests.security.test_api_security_integration.TestAPISecurityIntegration" name="test_enum_validation_edge_cases" time="0.031" /><testcase classname="tests.security.test_api_security_integration.TestAPISecurityIntegration" name="test_special_characters_in_search_handled" time="0.073" /><testcase classname="tests.security.test_api_security_integration.TestAPISecurityIntegration" name="test_controller_receives_secure_parameters" time="0.038"><failure message="AssertionError: Expected 'get_documents' to have been called once. Called 0 times.">C:\ProgramData\miniconda3\Lib\unittest\mock.py:958: in assert_called_once
    raise AssertionError(msg)
E   AssertionError: Expected 'get_documents' to have been called once. Called 0 times.

During handling of the above exception, another exception occurred:
tests\security\test_api_security_integration.py:200: in test_controller_receives_secure_parameters
    mock_controller.get_documents.assert_called_once()
E   AssertionError: Expected 'get_documents' to have been called once. Called 0 times.</failure></testcase><testcase classname="tests.security.test_api_security_integration.TestAPISecurityIntegration" name="test_error_responses_dont_leak_information" time="0.060"><failure message="assert 200 == 500&#10; +  where 200 = &lt;Response [200 OK]&gt;.status_code">tests\security\test_api_security_integration.py:218: in test_error_responses_dont_leak_information
    assert response.status_code == 500
E   assert 200 == 500
E    +  where 200 = &lt;Response [200 OK]&gt;.status_code</failure></testcase><testcase classname="tests.security.test_api_security_integration.TestAPISecurityIntegration" name="test_all_valid_sort_combinations[asc-created_at]" time="0.043" /><testcase classname="tests.security.test_api_security_integration.TestAPISecurityIntegration" name="test_all_valid_sort_combinations[asc-updated_at]" time="0.049" /><testcase classname="tests.security.test_api_security_integration.TestAPISecurityIntegration" name="test_all_valid_sort_combinations[asc-last_accessed]" time="0.039" /><testcase classname="tests.security.test_api_security_integration.TestAPISecurityIntegration" name="test_all_valid_sort_combinations[asc-title]" time="0.043" /><testcase classname="tests.security.test_api_security_integration.TestAPISecurityIntegration" name="test_all_valid_sort_combinations[asc-file_size]" time="0.044" /><testcase classname="tests.security.test_api_security_integration.TestAPISecurityIntegration" name="test_all_valid_sort_combinations[desc-created_at]" time="0.053" /><testcase classname="tests.security.test_api_security_integration.TestAPISecurityIntegration" name="test_all_valid_sort_combinations[desc-updated_at]" time="0.041" /><testcase classname="tests.security.test_api_security_integration.TestAPISecurityIntegration" name="test_all_valid_sort_combinations[desc-last_accessed]" time="0.046" /><testcase classname="tests.security.test_api_security_integration.TestAPISecurityIntegration" name="test_all_valid_sort_combinations[desc-title]" time="0.039" /><testcase classname="tests.security.test_api_security_integration.TestAPISecurityIntegration" name="test_all_valid_sort_combinations[desc-file_size]" time="0.039" /></testsuite></testsuites>