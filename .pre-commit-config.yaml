# ============================================================================
# AI Enhanced PDF Scholar - Simplified Pre-commit Configuration
# Core quality checks only - focused on essential standards
# ============================================================================

repos:
  # ============================================================================
  # Essential File Checks + lightweight security
  # ============================================================================
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.5.0
    hooks:
      - id: trailing-whitespace
        args: [--markdown-linebreak-ext=md]
      - id: end-of-file-fixer
      - id: check-merge-conflict
      - id: check-added-large-files
        args: [--maxkb=2000]  # 2MB limit (increased for PDFs/docs)
      - id: check-ast
      - id: debug-statements
      - id: check-yaml
        args: [--allow-multiple-documents]
        exclude: |
          (?x)^(
            k8s/helm/.*\.yaml|
            k8s/manifests/.*\.yaml|
            k8s/resources\.yaml|
            \.github/workflows/disabled/.*\.yml|
            frontend/\.github/workflows/.*\.yml
          )$
      - id: check-json
        exclude: |
          (?x)^(
            monitoring/.*-dashboard\.json|
            .*_service_report\.json|
            bandit-report\.json|
            frontend/tsconfig\.json
          )$
      - id: detect-private-key
        exclude: |
          (?x)^(
            GITHUB_SECRETS_GUIDE\.md|
            k8s/manifests/secrets\.yaml|
            docs/.*\.md|
            .*README.*\.md
          )$

  # ============================================================================
  # Ruff formatting + linting (mirrors CI and `make lint-staged`)
  # ============================================================================
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.5.7
    hooks:
      - id: ruff-format
        files: ^(src/|backend/|tests/|scripts/).*\.py$
      - id: ruff
        files: ^(src/|backend/|tests/|scripts/).*\.py$

  # ============================================================================
  # MyPy (touched files)
  # ============================================================================
  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.10.0
    hooks:
      - id: mypy
        args: [--config-file=mypy.ini]
        stages: [manual]  # run via `pre-commit run mypy --all-files` when needed
        additional_dependencies:
          - types-requests

# ============================================================================
# Configuration
# ============================================================================

# Update to modern stage names
default_stages: [pre-commit, pre-push]

# Language versions
default_language_version:
  python: python3

# Minimum version
minimum_pre_commit_version: 3.6.0

# CI skip list - skip complex checks in CI for speed
ci:
  skip: []
  autofix_prs: true
  autoupdate_schedule: weekly

# ============================================================================
# Usage Notes
# ============================================================================
# This simplified configuration focuses on:
# 1. Essential file format issues + merge hygiene
# 2. Ruff formatting + linting on only the touched Python files
# 3. MyPy on touched files (much faster than repo-wide runs)
# 4. Lightweight security (real private keys only) + large file prevention
#
# Removed from original config:
# - Complex YAML/JSON validation for config files
# - Test file naming enforcement (utility files are OK)
# - AWS credential detection (not used in this project)
# - Frontend linting (handled separately)
# - Documentation linting (too strict for development)
# - Comprehensive security scanning (too noisy)
# ============================================================================
